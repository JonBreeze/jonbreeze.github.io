
<!DOCTYPE html>
<html lang="en">
<head>
  <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" type="text/css" href="https://jonbreeze.github.io/theme/stylesheet/style.min.css">

  <link rel="stylesheet" type="text/css" href="https://jonbreeze.github.io/theme/pygments/github.min.css">
  <link rel="stylesheet" type="text/css" href="https://jonbreeze.github.io/theme/font-awesome/css/font-awesome.min.css">





  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="" />


<meta name="author" content="Jon Breeze" />
<meta name="description" content="MEEP modelling: Square Cavity – Part 2" />
<meta name="keywords" content="meep, electromagnetic">
<meta property="og:site_name" content="Jon(athan) Breeze's Blog"/>
<meta property="og:title" content="MEEP modelling: Square Cavity – Part 2"/>
<meta property="og:description" content="MEEP modelling: Square Cavity – Part 2"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://jonbreeze.github.io/meep-cavity-square-2.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2017-07-25 10:50:00+01:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="https://jonbreeze.github.io/author/jon-breeze.html">
<meta property="article:section" content="MEEP"/>
<meta property="article:tag" content="meep"/>
<meta property="article:tag" content="electromagnetic"/>
<meta property="og:image" content="/images/profile.jpg">

  <title>Jon(athan) Breeze's Blog &ndash; MEEP modelling: Square Cavity – Part 2</title>

</head>
<body>
  <aside>
    <div>
      <a href="https://jonbreeze.github.io">
        <img src="/images/profile.jpg" alt="Jon(athan) Breeze" title="Jon(athan) Breeze">
      </a>
      <h1><a href="https://jonbreeze.github.io">Jon(athan) Breeze</a></h1>

<p>theory | code | practice</p>

      <ul class="social">
        <li><a class="sc-linkedin" href="https://www.linkedin.com/in/jonathan-breeze-65166b82" target="_blank"><i class="fa fa-linkedin"></i></a></li>
        <li><a class="sc-github" href="https://github.com/jonbreeze" target="_blank"><i class="fa fa-github"></i></a></li>
        <li><a class="sc-twitter" href="https://twitter.com/jonbreeze" target="_blank"><i class="fa fa-twitter"></i></a></li>
      </ul>
    </div>


  </aside>
  <main>

    <nav>
      <a href="https://jonbreeze.github.io">    Home
</a>

      <a href="https://jonbreeze.github.io/about.html">About</a>
      <a href="https://jonbreeze.github.io/pubs.html">Publications</a>
      <a href="https://jonbreeze.github.io/category/masers.html">Masers</a>
      <a href="https://jonbreeze.github.io/archives.html">Archives</a>
      <a href="https://jonbreeze.github.io/categories.html">Categories</a>
      <a href="https://jonbreeze.github.io/tags.html">Tags</a>


    </nav>

<article class="single">
  <header>
    <h1 id="meep-cavity-square-2">MEEP modelling: Square Cavity – Part 2</h1>
    <p>
          Posted on Tue 25 July 2017 in <a href="https://jonbreeze.github.io/category/meep.html">MEEP</a>


    </p>
  </header>


  <div>
    <p>If we inspect the output from <code>meep</code> that we saved in file <code>square.ctl</code>:</p>
<div class="highlight"><pre><span></span>-----------
Initializing structure...
Working in 2D dimensions.
Computational cell is 1 x 1 x 0 with resolution 21
     block, center = (0,0,0)
          size (1,1,1e-20)
          axes (1,0,0), (0,1,0), (0,0,1)
          dielectric constant epsilon diagonal = (1,1,1)
time for set_epsilon = 0.00246215 s
-----------
Meep progress: 1265.7857142857142/2005.0 = 63.1% done in 4.0s, 2.3s to go
on time step 53163 (time=1265.79), 7.52429e-05 s/step
harminv0:, frequency, imag. freq., Q, |amp|, amplitude, error
harminv0:, 0.49965027602074025, 6.962901950688442e-8, -3587945.6551254354, 0.07777794402701167, 0.0024368236485488148+0.07773976117518522i, 2.1971119199697203e-8+0.0i
harminv0:, 0.7067768851898223, -7.597594046763396e-8, 4651320.410379862, 0.03547170560103376, -0.00560172786233135-0.03502659765382288i, 1.6310167415083462e-8+0.0i
harminv0:, 0.997198615390459, -2.2874161068410783e-8, 21797490.46113849, 0.30571523921562116, 0.30557359296981657-0.009305201135996685i, 4.379556711147102e-9+0.0i
harminv0:, 1.1157886868016782, -7.198145589973213e-9, 77505287.4976533, 0.18504732775678, -0.06019929248036505-0.17498159530301646i, 2.0145105671454234e-9+0.0i
harminv0:, 1.4115657086248123, 9.691822540596569e-8, -7282251.107632874, 0.09323703957434044, 0.08941825563599501-0.02641062489989536i, 1.2346770754915476e-8+0.0i
harminv0:, 1.490528739827691, 1.4909785346550363e-7, -4998491.611995442, 0.04358290725731711, 0.001576775048424593-0.043554375043691876i, 2.8521991089171737e-8+0.0i
harminv0:, 1.572707606509909, -8.635811826769853e-8, 9105731.100084461, 0.03510133186423594, -0.03341229909079056-0.01075740526850139i, 1.1398999164323018e-8+0.0i
harminv0:, 1.7956590548227003, 2.713483475275414e-7, -3308770.941824962, 0.0173063963599404, 0.017267776387618082-0.0011555317367245932i, 3.265935897573454e-8+0.0i
harminv0:, 1.9774955614133072, -3.2803139027426844e-7, 3014186.4773366884, 0.01085226263124576, -0.010634565235754036-0.002162782112008712i, 9.627394698484882e-8+0.0i
run 0 finished at t = 2005.0 (84210 timesteps)

Elapsed run time = 12.9194 s
</pre></div>


<p>we see that some resonant frequencies have been generated (look for lines beginning with <code>harminv0</code>)  Let's extract the frequencies with the unix command <code>grep harminv0 square.out | sed 's/,//g' | gawk '{printf "%.4f\n", $2}'</code>, which looks for lines containing the text <code>harminv</code>, removes commas and then takes the second column and prints the value to 4 decimal places:</p>
<div class="highlight"><pre><span></span>0.4997
0.7068
0.9972
1.1158
1.4116
1.4905
1.5727
1.7957
1.9775
</pre></div>


<p>We ignore the first entry <code>0.000</code> since it is the result of printing the second column of the legend <code>harminv0:, frequency, imag. freq., Q, |amp|, amplitude, error</code>.
Due to the simple geometry we can also calculate the frequency of the modes analytically using the expression
</p>
<div class="math">$$
f = \tfrac{1}{2} \sqrt{n_x^2 + n_y^2}
$$</div>
<p>
where <span class="math">\(n_x\)</span> and <span class="math">\(n_y\)</span> are the number of half-waves in the <span class="math">\(x\)</span> and <span class="math">\(y\)</span> directions.
This can be derived from the wavenumber <span class="math">\(k^2 = k_x^2 + k_y^2 = \pi^2(n_x^2+n_y^2)\)</span> and <span class="math">\(f =  \omega/2\pi = ck/2\pi\)</span>.
Since <span class="math">\(c=1\)</span> in <code>meep</code>, then
</p>
<div class="math">$$
f = \frac{ck}{2\pi} = \frac{\pi\sqrt{n_x^2+n_y^2}}{2\pi} = \tfrac{1}{2} \sqrt{n_x^2 + n_y^2}
$$</div>
<table>
<thead>
<tr>
<th><code>meep</code></th>
<th><span class="math">\(n_x\)</span></th>
<th><span class="math">\(n_y\)</span></th>
<th><span class="math">\(f\)</span></th>
<th><span class="math">\(f\)</span></th>
<th><span class="math">\(\Delta f\)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td>0.4996</td>
<td>0</td>
<td>1</td>
<td><span class="math">\(\tfrac{1}{2}\sqrt{0^2 + 1^2} = \tfrac{1}{2}\)</span></td>
<td>0.500</td>
<td>0.0004</td>
</tr>
<tr>
<td>0.7068</td>
<td>1</td>
<td>1</td>
<td><span class="math">\(\tfrac{1}{2}\sqrt{1^2 + 1^2} = \tfrac{\sqrt{2}}{2}\)</span></td>
<td>0.707</td>
<td>0.0002</td>
</tr>
<tr>
<td>0.9972</td>
<td>0</td>
<td>2</td>
<td><span class="math">\(\tfrac{1}{2}\sqrt{0^2 + 2^2} = 1\)</span></td>
<td>1.000</td>
<td>0.0028</td>
</tr>
<tr>
<td>1.1158</td>
<td>1</td>
<td>2</td>
<td><span class="math">\(\tfrac{1}{2}\sqrt{1^2 + 2^2} = \tfrac{\sqrt{5}}{2}\)</span></td>
<td>1.118</td>
<td>0.0022</td>
</tr>
<tr>
<td>1.4116</td>
<td>2</td>
<td>2</td>
<td><span class="math">\(\tfrac{1}{2}\sqrt{2^2 + 2^2} = \sqrt{2}\)</span></td>
<td>1.414</td>
<td>0.0024</td>
</tr>
<tr>
<td>1.4905</td>
<td>0</td>
<td>3</td>
<td><span class="math">\(\tfrac{1}{2}\sqrt{0^2 + 3^2} = \tfrac{3}{2}\)</span></td>
<td>1.500</td>
<td>0.0095</td>
</tr>
<tr>
<td>1.5727</td>
<td>1</td>
<td>3</td>
<td><span class="math">\(\tfrac{1}{2}\sqrt{1^2 + 3^2} = \tfrac{\sqrt{10}}{2}\)</span></td>
<td>1.581</td>
<td>0.0083</td>
</tr>
<tr>
<td>1.7957</td>
<td>2</td>
<td>3</td>
<td><span class="math">\(\tfrac{1}{2}\sqrt{2^2 + 3^2} = \tfrac{\sqrt{13}}{2}\)</span></td>
<td>1.803</td>
<td>0.0073</td>
</tr>
<tr>
<td>1.9775</td>
<td>0</td>
<td>4</td>
<td><span class="math">\(\tfrac{1}{2}\sqrt{0^2 + 4^2} = 2\)</span></td>
<td>2.000</td>
<td>0.0225</td>
</tr>
</tbody>
</table>
<p>If we set the excitation to <span class="math">\(E_z\)</span> then we do not excite as many modes. This is because the boundary conditions do not permit either <span class="math">\(n_x = 0\)</span> or <span class="math">\(n_y\)</span> = 0.</p>
<table>
<thead>
<tr>
<th><code>meep</code></th>
<th><span class="math">\(n_x\)</span></th>
<th><span class="math">\(n_y\)</span></th>
<th><span class="math">\(f\)</span></th>
<th><span class="math">\(f\)</span></th>
<th><span class="math">\(\Delta f\)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td>0.7068</td>
<td>1</td>
<td>1</td>
<td><span class="math">\(\tfrac{1}{2}\sqrt{1^2 + 1^2} = \tfrac{\sqrt{2}}{2}\)</span></td>
<td>0.707</td>
<td>0.0002</td>
</tr>
<tr>
<td>1.1158</td>
<td>1,2</td>
<td>2,1</td>
<td><span class="math">\(\tfrac{1}{2}\sqrt{1^2 + 2^2} = \tfrac{\sqrt{5}}{2}\)</span></td>
<td>1.118</td>
<td>0.0022</td>
</tr>
<tr>
<td>1.4116</td>
<td>2</td>
<td>2</td>
<td><span class="math">\(\tfrac{1}{2}\sqrt{2^2 + 2^2} = \sqrt{2}\)</span></td>
<td>1.414</td>
<td>0.0024</td>
</tr>
<tr>
<td>1.5727</td>
<td>1,3</td>
<td>3,1</td>
<td><span class="math">\(\tfrac{1}{2}\sqrt{1^2 + 3^2} = \tfrac{\sqrt{10}}{2}\)</span></td>
<td>1.581</td>
<td>0.0083</td>
</tr>
<tr>
<td>1.7957</td>
<td>2,3</td>
<td>3,2</td>
<td><span class="math">\(\tfrac{1}{2}\sqrt{2^2 + 3^2} = \tfrac{\sqrt{13}}{2}\)</span></td>
<td>1.803</td>
<td>0.0073</td>
</tr>
</tbody>
</table>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="https://jonbreeze.github.io/tag/meep.html">meep</a>
      <a href="https://jonbreeze.github.io/tag/electromagnetic.html">electromagnetic</a>
    </p>
  </div>




</article>

    <footer>
<p>&copy; Jonathan Breeze </p>
<p>    Powered by <a href="http://getpelican.com" target="_blank">Pelican</a> - <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> theme by <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a>
</p>    </footer>
  </main>





<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Jon(athan) Breeze's Blog ",
  "url" : "https://jonbreeze.github.io",
  "image": "/images/profile.jpg",
  "description": "Thoughts and Writings"
}
</script>
</body>
</html>